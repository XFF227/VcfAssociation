% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/gwas_single.R
\name{gwas_single}
\alias{gwas_single}
\title{Single-variant GWAS using GLM per site}
\usage{
gwas_single(
  genotypes,
  phenotypes,
  id_col,
  pheno_col,
  covars = character(),
  family = c("gaussian", "binomial"),
  p_adjust = "BH"
)
}
\arguments{
\item{genotypes}{Long genotype table from \code{read_vcf()}.}

\item{phenotypes}{Phenotype data including id and trait.}

\item{id_col}{Sample id column in \code{phenotypes}.}

\item{pheno_col}{Phenotype column.}

\item{covars}{Optional covariate column names.}

\item{family}{"gaussian" (quantitative) or "binomial" (binary).}

\item{p_adjust}{Method for \code{p.adjust}.}
}
\value{
list(results=data.frame, manhattan=ggplot)
}
\description{
Fit GLM per variant with optional covariates; return results and Manhattan plot.
}
\details{
gwas_single
}
\examples{
\dontrun{
g <- v$genotypes
ph <- readr::read_csv("pheno.csv")
out <- gwas_single(g, ph, id_col="sample_id", pheno_col="trait", covars=c("age","sex"), family="binomial")
out$manhattan
dplyr::arrange(out$results, padj)[1:10,]
}
}
