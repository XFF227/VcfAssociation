% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/generate_phenotypes.R
\name{generate_phenotype}
\alias{generate_phenotype}
\title{Generate simple phenotype data from a single variant}
\usage{
generate_phenotype(
  vcf_path,
  chrom,
  pos,
  model = c("carrier", "additive"),
  out_csv = NULL,
  sample_col = "sample"
)
}
\arguments{
\item{vcf_path}{Path to the input VCF file.}

\item{chrom}{Chromosome of the variant to extract.}

\item{pos}{Position (1-based) of the variant to extract.}

\item{model}{Either "carrier" or "additive".}

\item{out_csv}{Optional path to save the generated phenotype table as CSV.}

\item{sample_col}{Name of the sample ID column in the output.}
}
\value{
A data frame with sample IDs and phenotype values.
}
\description{
This function is the second step in the workflow. It selects one variant
(identified by chromosome and position) from the VCF data and converts its
ALT-allele dosage into a phenotype. Depending on the model:
\itemize{
\item "carrier" gives binary 0/1 for presence of any ALT allele,
\item "additive" uses the dosage value directly (0, 1, 2).
}

The result can be saved as a CSV file and used later by read_phenotypes().
}
\details{
generate_phenotype
}
\examples{
vcf_path <- system.file("extdata", "toy.vcf",
                        package = "VcfAssociation", mustWork = TRUE)
ph <- generate_phenotype(vcf_path,
                         chrom = "chr12", pos = 11161,
                         model = "carrier")
head(ph)

tmp <- tempfile(fileext = ".csv")
ph_add <- generate_phenotype(vcf_path,
                             chrom = "chr12", pos = 11161,
                             model = "additive",
                             out_csv = tmp)
head(ph_add)
}
\references{
\strong{stats}: R Core Team. (2025). \emph{R: A Language and Environment for Statistical Computing.}
R Foundation for Statistical Computing, Vienna, Austria.
\url{https://www.R-project.org/}
}
\seealso{
read_vcf, read_phenotypes
}
