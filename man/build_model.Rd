% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/build_model.R
\name{build_model}
\alias{build_model}
\title{Fit gene- or region-level association models}
\usage{
build_model(
  df_list,
  outcomes,
  dosage = "Dosage",
  covars = character(),
  model = c("logistic", "linear"),
  maxit = 50
)
}
\arguments{
\item{df_list}{List of data frames prepared by prepare_list().}

\item{outcomes}{Phenotype column names.}

\item{dosage}{Name of dosage column.}

\item{covars}{Optional covariate names.}

\item{model}{Either "logistic" or "linear".}

\item{maxit}{Maximum iterations for Firth logistic (default 50).}
}
\value{
A data frame summarizing coefficients, standard errors, and p-values.
}
\description{
\code{build_model()} fits gene- or region-level association models on the
list of data.frames from \code{prepare_list()}. It merges phenotype, dosage,
and optional covariates into a modeling dataset and automatically chooses
between linear (\code{lm}) and Firth-penalized logistic (\code{logistf}) regression.

For linear models, the function reports per-variant coefficients, standard
errors, p-values, and confidence intervals. For logistic models, it first
screens variants in univariate Firth regressions to remove non-convergent
or unstable ones, then fits a joint model on the remaining variants and
iteratively drops those causing instability.

Results include beta, SE, p, CI, and odds ratios where applicable. Variants
excluded due to missing columns, insufficient sample size, or model failure
return \code{NA} estimates with a brief reason in the \code{error} column.
}
\details{
build_model
}
