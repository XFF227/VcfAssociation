% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/build_model.R
\name{build_model}
\alias{build_model}
\title{Fit gene- or region-level association models}
\usage{
build_model(
  df_list,
  outcomes,
  dosage = "Dosage",
  covars = character(),
  model = c("logistic", "linear")
)
}
\arguments{
\item{df_list}{List of data frames prepared by prepare_list().}

\item{outcomes}{Phenotype column names.}

\item{dosage}{Name of dosage column.}

\item{covars}{Optional covariate names.}

\item{model}{Either "logistic" or "linear".}
}
\value{
A data frame summarizing coefficients, standard errors, and p-values.
}
\description{
This function performs multi-variant modeling using data prepared by
prepare_list(). It fits linear or logistic (Firth) regression models that link
phenotype to one or more genotype dosages and optional covariates.
It is used to identify the joint effect of variants within a locus or gene.
}
\details{
build_model
}
\examples{
vcf_path <- system.file("extdata", "toy.vcf",
                        package = "VcfAssociation", mustWork = TRUE)
vcf <- read_vcf(vcf_path)
ph <- generate_phenotype(vcf_path,
                         chrom = "chr12", pos = 11161,
                         model = "carrier")
tmp <- tempfile(fileext = ".csv")
write.csv(ph, tmp, row.names = FALSE)
ph_list <- read_phenotypes(tmp, id_col = "sample", genotypes = vcf$genotypes)
variants <- data.frame(CHROM = "chr12", POS = c(10537, 12180, 12372))
df_list <- prepare_list(ph_list, variants, phenotypes = "phenotype")
res <- build_model(df_list, outcomes = "phenotype", model = "logistic")
head(res)
}
\references{
\strong{stats}: R Core Team. (2025). \emph{R: A Language and Environment for Statistical Computing.}
R Foundation for Statistical Computing, Vienna, Austria.
\url{https://www.R-project.org/}

\strong{dplyr}: Wickham, H., François, R., Henry, L., & Müller, K. (2023).
\emph{dplyr: A Grammar of Data Manipulation.} R package version 1.x.
\url{https://CRAN.R-project.org/package=dplyr}
}
\seealso{
forest_plot
}
